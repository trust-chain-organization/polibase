# Polibase - æ”¿æ²»æ´»å‹•è¿½è·¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

[![Tests](https://github.com/trust-chain-organization/polibase/actions/workflows/test.yml/badge.svg)](https://github.com/trust-chain-organization/polibase/actions/workflows/test.yml)
[![Type Check](https://github.com/trust-chain-organization/polibase/actions/workflows/pyright.yml/badge.svg)](https://github.com/trust-chain-organization/polibase/actions/workflows/pyright.yml)
[![codecov](https://codecov.io/gh/trust-chain-organization/polibase/branch/main/graph/badge.svg)](https://codecov.io/gh/trust-chain-organization/polibase)

æ”¿æ²»å®¶ã®ç™ºè¨€ã€è­°äº‹éŒ²ã€å…¬ç´„ãªã©ã‚’ä½“ç³»çš„ã«ç®¡ç†ãƒ»åˆ†æã™ã‚‹ãŸã‚ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ğŸ—„ï¸ ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ 
è©³ç´°ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¯ã“ã¡ã‚‰ã‚’ã”ç¢ºèªãã ã•ã„ï¼š
https://dbdocs.io/polibase/Polibase

### ä¸»è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å½¹å‰²

- **Speaker**: è­°äº‹éŒ²ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸç™ºè¨€è€…ã€‚è­°äº‹éŒ²ã«ãŠã‘ã‚‹æ”¿æ²»å®¶ã®è¡¨ç¾ï¼ˆä¾‹ï¼šã€Œå±±ç”°å¤ªéƒå›ã€ã€Œå±±ç”°è­°å“¡ã€ãªã©ï¼‰ã‚’è¨˜éŒ²
- **Politician**: æ”¿æ²»å®¶ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã€‚è­°äº‹éŒ²ç”±æ¥ï¼ˆspeaker_idæœ‰ï¼‰ã¨æ”¿å…šã‚µã‚¤ãƒˆç”±æ¥ï¼ˆspeaker_idç„¡ï¼‰ã®ä¸¡æ–¹ã‚’ç®¡ç†
- **ExtractedPolitician**: æ”¿å…šã‚µã‚¤ãƒˆã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸæ”¿æ²»å®¶ã®ä¸­é–“ãƒ‡ãƒ¼ã‚¿ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œã«æ‰¿èªã•ã‚Œã‚‹ã¨Politicianãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤‰æ›ã•ã‚Œã‚‹
- **PoliticalParty**: æ”¿å…šãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
- **Conversation**: è­°äº‹éŒ²ã®ç™ºè¨€å†…å®¹

## ğŸš€ ç’°å¢ƒæ§‹ç¯‰æ‰‹é †

### å‰ææ¡ä»¶
- Docker & Docker Compose
- Python 3.13
- uvï¼ˆPythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰
- Google Cloud SDKï¼ˆGCSæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
```bash
git clone https://github.com/trust-chain-organization/polibase.git
cd polibase
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆå¿…è¦ã«å¿œã˜ã¦è¨­å®šã‚’èª¿æ•´ï¼‰
cp .env.example .env

# Google Gemini APIã‚­ãƒ¼ã‚’è¨­å®šï¼ˆè­°äº‹éŒ²å‡¦ç†ã«å¿…è¦ï¼‰
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®GOOGLE_API_KEYã‚’å®Ÿéš›ã®APIã‚­ãƒ¼ã«ç½®ãæ›ãˆã¦ãã ã•ã„
```

**é‡è¦**: Google Gemini APIã‚­ãƒ¼ã¯ä»¥ä¸‹ã§å–å¾—ã§ãã¾ã™ï¼š
- [Google AI Studio](https://aistudio.google.com/)ã§APIã‚­ãƒ¼ã‚’å–å¾—
- `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®`GOOGLE_API_KEY`ã«è¨­å®š

**Google Cloud Storageï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**:
- ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’GCSã«ä¿å­˜ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®è¨­å®šã‚‚å¿…è¦ã§ã™ï¼š
  - `gcloud auth application-default login`ã§èªè¨¼
  - `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã§`GCS_BUCKET_NAME`ã¨`GCS_UPLOAD_ENABLED=true`ã‚’è¨­å®š

### 3. Dockerç’°å¢ƒã®èµ·å‹•
```bash
# PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
docker compose -f docker/docker-compose.yml up -d

# ãƒ­ã‚°ã®ç¢ºèª
docker compose -f docker/docker-compose.yml logs -f
```

### 4. Pythonä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰
```bash
# uvã‚’ä½¿ç”¨ã—ã¦ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync
```

### 5. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç¢ºèª
```bash
# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒæ­£å¸¸ã«å®Œäº†ã—ãŸã‹ç¢ºèª
./scripts/test-setup.sh
```

## ğŸƒ ä½¿ç”¨æ–¹æ³•

### ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³

Polibaseã¯ä»¥ä¸‹ã®è¨­è¨ˆåŸå‰‡ã«åŸºã¥ã„ã¦æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **æ”¿æ²»å®¶ã®æƒ…å ±ã¯æ”¿å…šã®Webã‚µã‚¤ãƒˆã‹ã‚‰å–å¾—**
   - å„æ”¿å…šã®å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰æœ€æ–°ã®è­°å“¡æƒ…å ±ã‚’å®šæœŸçš„ã«å–å¾—
   - åå‰ã€æ‰€å±ã€å½¹è·ã€é¸æŒ™åŒºãªã©ã®æƒ…å ±ã‚’æ§‹é€ åŒ–ã—ã¦ä¿å­˜

2. **ç™ºè¨€è€…ã¨ç™ºè¨€å†…å®¹ã¯è­°äº‹éŒ²ã‹ã‚‰æŠ½å‡º**
   - è­°äº‹éŒ²PDFã‚„Webãƒšãƒ¼ã‚¸ã‹ã‚‰ç™ºè¨€è€…åã¨ç™ºè¨€å†…å®¹ã‚’è‡ªå‹•æŠ½å‡º
   - ç™ºè¨€é †åºã‚„æ–‡è„ˆã‚’ä¿æŒã—ãŸã¾ã¾æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿å­˜

3. **ç™ºè¨€è€…ã¨æ”¿æ²»å®¶ã¯LLMã‚’åˆ©ç”¨ã—ã¦ç´ä»˜ã‘**
   - è¡¨è¨˜æºã‚Œã‚„æ•¬ç§°ã®é•ã„ã«å¯¾å¿œã™ã‚‹é«˜ç²¾åº¦ãƒãƒƒãƒãƒ³ã‚°
   - ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ + LLMãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

4. **ä¼šè­°ä½“ã®æ‰€å±è­°å“¡æƒ…å ±ã¯æ®µéšçš„ã«æŠ½å‡ºãƒ»ãƒãƒƒãƒãƒ³ã‚°**
   - è­°ä¼šã®è­°å“¡ç´¹ä»‹ãƒšãƒ¼ã‚¸ã‹ã‚‰æƒ…å ±ã‚’è‡ªå‹•æŠ½å‡º
   - ä¸­é–“ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç¢ºèªãƒ»ä¿®æ­£ãŒå¯èƒ½
   - LLMã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªæ—¢å­˜æ”¿æ²»å®¶ã¨ã®ãƒãƒƒãƒãƒ³ã‚°

5. **è­°å“¡å›£ï¼ˆä¼šæ´¾ï¼‰ã«ã‚ˆã‚‹æ”¿ç­–ã®è³›å¦ã‚’ç®¡ç†**
   - è­°å“¡å›£å˜ä½ã§ã®è³›æˆãƒ»åå¯¾ã‚’è¨˜éŒ²
   - æ”¿æ²»å®¶ã®è­°å“¡å›£æ‰€å±å±¥æ­´ã‚’ç®¡ç†
   - è­°æ¡ˆã¸ã®è³›å¦ã‚’å€‹äººãƒ»æ”¿å…šãƒ»è­°å“¡å›£ã§åˆ†æå¯èƒ½

6. **ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã¯Streamlit UIã‚’é€šã˜ã¦**
   - æ”¿å…šã®è­°å“¡ä¸€è¦§URLã®è¨­å®š
   - è­°äº‹éŒ²URLã®ç™»éŒ²ã¨ç®¡ç†
   - ä¼šè­°ä½“ã®è­°å“¡ç´¹ä»‹URLã®è¨­å®š
   - ç›´æ„Ÿçš„ãªWebã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§æ“ä½œ

7. **ãƒ‡ãƒ¼ã‚¿ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å¯è¦–åŒ–**
   - å…¨å›½ã®è­°ä¼šãƒ»è­°äº‹éŒ²ãƒ‡ãƒ¼ã‚¿ã®å…¥åŠ›çŠ¶æ³ã‚’ä¸€è¦§è¡¨ç¤º
   - è­°ä¼šåˆ¥ãƒ»éƒ½é“åºœçœŒåˆ¥ãƒ»æ”¿å…šåˆ¥ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã‚’è¦–è¦šåŒ–
   - æ™‚ç³»åˆ—ã§ã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›æ¨ç§»ã‚’åˆ†æ
   - ãƒ‡ãƒ¼ã‚¿å……å®Ÿåº¦ã®ä½ã„é ˜åŸŸã‚’ç‰¹å®šã—ã¦åŠ¹ç‡çš„ãªä½œæ¥­ãŒå¯èƒ½

8. **LLMå‡¦ç†å±¥æ­´ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**
   - ã™ã¹ã¦ã®LLMå‡¦ç†ï¼ˆè­°äº‹éŒ²åˆ†å‰²ã€ç™ºè¨€è€…æŠ½å‡ºã€æ”¿æ²»å®¶ãƒãƒƒãƒãƒ³ã‚°ç­‰ï¼‰ã®å±¥æ­´ã‚’è¨˜éŒ²
   - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã«ã‚ˆã‚Šå†ç¾æ€§ã‚’ç¢ºä¿
   - å‡¦ç†ã®æˆåŠŸ/å¤±æ•—ã€ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«ã€ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ãªã©ã‚’è¿½è·¡
   - A/Bãƒ†ã‚¹ãƒˆã‚„æ”¹å–„ã®ãŸã‚ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå±¥æ­´åˆ†æãŒå¯èƒ½

### ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

ğŸ“š **ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã®è©³ç´°ã¯ [COMMANDS.md](COMMANDS.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

ä»¥ä¸‹ã¯åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹ã§ã™ï¼š

### ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# è­°äº‹éŒ²ã‚’å‡¦ç†ï¼ˆç™ºè¨€ã‚’æŠ½å‡ºï¼‰
docker compose -f docker/docker-compose.yml exec polibase uv run polibase process-minutes

# ä¼šè­°ç®¡ç†Web UIã‚’èµ·å‹•
docker compose -f docker/docker-compose.yml exec polibase uv run polibase streamlit

# ãƒ‡ãƒ¼ã‚¿ã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’èµ·å‹•
docker compose -f docker/docker-compose.yml exec polibase uv run polibase monitoring
```

### ä¸»è¦ãªæ©Ÿèƒ½

#### è­°äº‹éŒ²å‡¦ç†
è­°äº‹éŒ²PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ç™ºè¨€å˜ä½ã«åˆ†å‰²ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã—ã¾ã™ã€‚

#### ä¼šè­°ç®¡ç†Web UI
Webãƒ–ãƒ©ã‚¦ã‚¶ã§ä¼šè­°æƒ…å ±ï¼ˆURLã€æ—¥ä»˜ï¼‰ã¨æ”¿å…šæƒ…å ±ã‚’ç®¡ç†ã§ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ï¼š
- ä¼šè­°ä¸€è¦§ã®è¡¨ç¤ºãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- æ–°è¦ä¼šè­°ã®ç™»éŒ²ï¼ˆé–‹å‚¬ä¸»ä½“ã€ä¼šè­°ä½“ã€æ—¥ä»˜ã€URLï¼‰
- æ—¢å­˜ä¼šè­°ã®ç·¨é›†ãƒ»å‰Šé™¤
- æ”¿å…šç®¡ç†ï¼ˆè­°å“¡ä¸€è¦§ãƒšãƒ¼ã‚¸URLã®è¨­å®šï¼‰

ã‚¢ã‚¯ã‚»ã‚¹URL: http://localhost:8501

#### ãƒ‡ãƒ¼ã‚¿ã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã®é€²æ—çŠ¶æ³ã‚’å¯è¦–åŒ–ã™ã‚‹ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æä¾›ã—ã¾ã™ï¼š
- **å…¨ä½“æ¦‚è¦**: è­°ä¼šæ•°ã€ä¼šè­°æ•°ã€è­°äº‹éŒ²æ•°ã€æ”¿æ²»å®¶æ•°ãªã©ã®ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **æ—¥æœ¬åœ°å›³è¡¨ç¤º**: éƒ½é“åºœçœŒã”ã¨ã®ãƒ‡ãƒ¼ã‚¿å……å®Ÿåº¦ã‚’åœ°å›³ä¸Šã§å¯è¦–åŒ–
- **è­°ä¼šåˆ¥ã‚«ãƒãƒ¬ãƒƒã‚¸**: å„è­°ä¼šã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ç‡ã‚’ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã§è¡¨ç¤º
- **æ™‚ç³»åˆ—åˆ†æ**: ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã®æ¨ç§»ã‚’æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•ã§ç¢ºèª

ã‚¢ã‚¯ã‚»ã‚¹URL: http://localhost:8502 ï¼ˆDocker Composeä½¿ç”¨æ™‚ï¼‰

### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
docker compose -f docker/docker-compose.yml exec polibase uv run pytest

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
uv run pytest tests/test_minutes_divider.py -v
```

## ğŸ—ƒï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¢ºèªæ–¹æ³•

### ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦

**é–‹å‚¬ä¸»ä½“ï¼ˆgoverning_bodiesï¼‰ã¨ä¼šè­°ä½“ï¼ˆconferencesï¼‰**ã¯åŸºæœ¬çš„ã«å¢—æ¸›ã—ãªã„å›ºå®šçš„ãªãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®SEEDãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†ã—ã¦ã„ã¾ã™ï¼š

- `database/seed_governing_bodies_generated.sql`: æ—¥æœ¬å›½ã€47éƒ½é“åºœçœŒã€å…¨å›½1,939å¸‚ç”ºæ‘ï¼ˆå…¨è‡ªæ²»ä½“ï¼‰
- `database/seed_conferences_generated.sql`: å›½ä¼šãƒ»å„å§”å“¡ä¼šã€éƒ½é“åºœçœŒè­°ä¼šã€å¸‚åŒºè­°ä¼š
- `database/seed_political_parties_generated.sql`: ä¸»è¦æ”¿å…šã€åœ°åŸŸæ”¿å…šã€éå»ã®æ”¿å…šï¼ˆä¼šå“¡ãƒªã‚¹ãƒˆURLã‚’å«ã‚€ï¼‰

ã“ã‚Œã‚‰ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–æ™‚ã«è‡ªå‹•çš„ã«æŠ•å…¥ã•ã‚Œã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é‹ç”¨ä¸­ã¯åŸºæœ¬çš„ã«å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ã€‚

### 1. PostgreSQLã«æ¥ç¶š
```bash
# Dockerç’°å¢ƒã®PostgreSQLã«æ¥ç¶š
docker compose -f docker/docker-compose.yml exec postgres psql -U polibase_user -d polibase_db
```

### 2. åŸºæœ¬çš„ãªSQLã‚¯ã‚¨ãƒªä¾‹
```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’ç¢ºèª
\dt

-- æ”¿å…šä¸€è¦§ã‚’ç¢ºèª
SELECT * FROM political_parties;

-- é–‹å‚¬ä¸»ä½“ã‚’ç¢ºèª
SELECT * FROM governing_bodies;

-- ä¼šè­°ä½“ã‚’ç¢ºèª
SELECT c.*, g.name as governing_body_name
FROM conferences c
JOIN governing_bodies g ON c.governing_body_id = g.id;

-- ç™ºè¨€ãƒ‡ãƒ¼ã‚¿ã¨ç™ºè¨€è€…ã®ç´ä»˜ã‘çŠ¶æ³ã‚’ç¢ºèª
SELECT
    COUNT(*) as total_conversations,
    COUNT(speaker_id) as linked_conversations,
    COUNT(*) - COUNT(speaker_id) as unlinked_conversations
FROM conversations;

-- ç™ºè¨€ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªï¼ˆã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚‹å ´åˆï¼‰
SELECT s.name as speaker_name, c.comment, c.sequence_number
FROM conversations c
JOIN speakers s ON c.speaker_id = s.id
LIMIT 10;
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
```bash
# Pythonã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆ
docker compose -f docker/docker-compose.yml exec polibase uv run python -c "
from src.config.database import test_connection
test_connection()
"
```

## ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ°¸ç¶šåŒ–ã¨ãƒªã‚»ãƒƒãƒˆ

### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã«ã¤ã„ã¦

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼ˆæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ï¼‰**:
- `docker compose.yml`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯è‡ªå‹•çš„ã«æ°¸ç¶šåŒ–ã•ã‚Œã¾ã™
- `postgres_data`ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã€ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ãƒ»å†èµ·å‹•ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã¾ã™

```bash
# æ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
docker compose -f docker/docker-compose.yml up -d

# ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã‚‹
docker compose -f docker/docker-compose.yml down
docker compose -f docker/docker-compose.yml up -d  # ãƒ‡ãƒ¼ã‚¿ãŒãã®ã¾ã¾æ®‹ã‚‹
```

**éæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ï¼ˆä¸€æ™‚çš„ãªä½¿ç”¨ï¼‰**:
- ãƒ†ã‚¹ãƒˆã‚„ä¸€æ™‚çš„ãªä½¿ç”¨ã®å ´åˆã¯ã€éæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™
- ã‚³ãƒ³ãƒ†ãƒŠåœæ­¢æ™‚ã«ãƒ‡ãƒ¼ã‚¿ã¯å…¨ã¦å‰Šé™¤ã•ã‚Œã¾ã™

```bash
# éæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
docker compose -f docker/docker-compose.temp.yml up -d

# ã¾ãŸã¯ã€æ—¢å­˜ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ä½¿ç”¨ã›ãšã«èµ·å‹•
docker compose -f docker/docker-compose.yml down -v
docker compose -f docker/docker-compose.yml up -d --renew-anon-volumes
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚»ãƒƒãƒˆ

#### å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆæ¨å¥¨ï¼‰
```bash
# è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒªã‚»ãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨
./scripts/reset-database.sh
```

#### æ‰‹å‹•ãƒªã‚»ãƒƒãƒˆ
```bash
# 1. ã‚³ãƒ³ãƒ†ãƒŠã¨ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å®Œå…¨å‰Šé™¤
docker compose -f docker/docker-compose.yml down -v

# 2. å†èµ·å‹•ï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿ã§å¾©å…ƒï¼‰
docker compose -f docker/docker-compose.yml up -d
```

### ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢

Polibaseã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¨Google Cloud Storageï¼ˆGCSï¼‰ã®ä¸¡æ–¹ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä¿å­˜ã§ãã¾ã™ã€‚

**GCSé€£æºã®è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**:
- GCSã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€äº‹å‰ã«ä»¥ä¸‹ã®è¨­å®šãŒå¿…è¦ã§ã™ï¼š
  1. `gcloud auth application-default login`ã§èªè¨¼
  2. `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã§`GCS_BUCKET_NAME`ã¨`GCS_UPLOAD_ENABLED=true`ã‚’è¨­å®š
- GCSãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€è‡ªå‹•çš„ã«ãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ãªã‚Šã¾ã™

#### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã¨GCSã®ä¸¡æ–¹ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database backup

# ãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database backup --no-gcs

# å¾“æ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰
./scripts/backup-database.sh backup
```

#### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸€è¦§ã®ç¢ºèª
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã¨GCSã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database list

# ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã¿è¡¨ç¤º
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database list --no-gcs

# å¾“æ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨
./scripts/backup-database.sh list
```

#### ãƒªã‚¹ãƒˆã‚¢å®Ÿè¡Œ
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database restore database/backups/polibase_backup_20241230_123456.sql

# GCSã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢
docker compose -f docker/docker-compose.yml exec polibase uv run polibase database restore gs://polibase-scraped-minutes/database-backups/polibase_backup_20241230_123456.sql

# å¾“æ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰
./scripts/backup-database.sh restore database/backups/polibase_backup_20240529_123456.sql
```

#### æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢
```bash
# æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker compose -f docker/docker-compose.yml exec postgres pg_dump -U polibase_user polibase_db > backup.sql

# æ‰‹å‹•ãƒªã‚¹ãƒˆã‚¢
docker compose -f docker/docker-compose.yml exec -T postgres psql -U polibase_user -d polibase_db < backup.sql
```

## ğŸ”§ é–‹ç™º

### ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°
```bash
# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
docker compose -f docker/docker-compose.yml exec polibase uv run --frozen ruff format .

# ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°
docker compose -f docker/docker-compose.yml exec polibase uv run --frozen ruff check .

# å‹ãƒã‚§ãƒƒã‚¯
docker compose -f docker/docker-compose.yml exec polibase uv run --frozen pyright
```

è©³ç´°ãªé–‹ç™ºç”¨ã‚³ãƒãƒ³ãƒ‰ã¯ [COMMANDS.md](COMMANDS.md#é–‹ç™ºç”¨ã‚³ãƒãƒ³ãƒ‰) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“Š ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ 

Polibaseã«ã¯ã€Grafanaã€Prometheusã€Lokiã‚’ä½¿ç”¨ã—ãŸåŒ…æ‹¬çš„ãªç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

### ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•

```bash
# ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•
docker compose -f docker/docker-compose.yml -f docker/docker-compose.monitoring.yml up -d

# å‹•ä½œç¢ºèª
docker compose -f docker/docker-compose.yml exec polibase uv run python scripts/verify_monitoring.py
```

### ã‚¢ã‚¯ã‚»ã‚¹URL

- **Grafana**: http://localhost:3000 (åˆæœŸ: admin/admin)
- **Prometheus**: http://localhost:9091
- **Loki**: http://localhost:3100

### æä¾›ã•ã‚Œã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

1. **ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦**: ç¨¼åƒçŠ¶æ³ã€ã‚¨ãƒ©ãƒ¼ç‡ã€å‡¦ç†æ¸ˆã¿è­°äº‹éŒ²æ•°
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: APIå¿œç­”æ™‚é–“ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ€§èƒ½ã€LLMä½¿ç”¨çŠ¶æ³
3. **ã‚¨ãƒ©ãƒ¼è¿½è·¡**: ã‚¨ãƒ©ãƒ¼ç‡ã®æ¨ç§»ã€ã‚¿ã‚¤ãƒ—åˆ¥åˆ†æã€ãƒ­ã‚°æ¤œç´¢
4. **ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹**: è­°äº‹éŒ²å‡¦ç†çµ±è¨ˆã€ãƒ‡ãƒ¼ã‚¿å“è³ªæŒ‡æ¨™

### ä¸»è¦ãªãƒ¡ãƒˆãƒªã‚¯ã‚¹

- ã‚·ã‚¹ãƒ†ãƒ ã®å¯ç”¨æ€§ï¼ˆSLO: > 99.5%ï¼‰
- P95ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ï¼ˆSLO: < 2ç§’ï¼‰
- ã‚¨ãƒ©ãƒ¼ç‡ï¼ˆSLO: < 1%ï¼‰
- LLMãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã¨ã‚³ã‚¹ãƒˆæ¨å®š

è©³ç´°ãªè¨­å®šã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•ã¯ [ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](docs/monitoring/grafana-setup.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## âš™ï¸ ç’°å¢ƒå¤‰æ•°è¨­å®š

ä¸»è¦ãªç’°å¢ƒå¤‰æ•°ï¼ˆ`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šï¼‰:

### å¿…é ˆè¨­å®š
- `GOOGLE_API_KEY`: Google Gemini APIã‚­ãƒ¼ï¼ˆè­°äº‹éŒ²å‡¦ç†ãƒ»æ”¿æ²»å®¶æŠ½å‡ºã«å¿…è¦ï¼‰
- `DATABASE_URL`: PostgreSQLæ¥ç¶šURLï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `postgresql://polibase_user:polibase_password@localhost:5432/polibase_db`ï¼‰

### ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆç§’å˜ä½ï¼‰
- `WEB_SCRAPER_TIMEOUT`: Webãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 60ç§’ï¼‰
- `PDF_DOWNLOAD_TIMEOUT`: PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 120ç§’ï¼‰
- `PAGE_LOAD_TIMEOUT`: ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹å¾…æ©Ÿã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30ç§’ï¼‰
- `SELECTOR_WAIT_TIMEOUT`: ã‚»ãƒ¬ã‚¯ã‚¿å¾…æ©Ÿã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10ç§’ï¼‰

### ãã®ä»–ã®è¨­å®š
- `LLM_MODEL`: ä½¿ç”¨ã™ã‚‹LLMãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `gemini-2.0-flash`ï¼‰
- `LLM_TEMPERATURE`: LLMã®æ¸©åº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.0ï¼‰
- `GCS_BUCKET_NAME`: Google Cloud Storageãƒã‚±ãƒƒãƒˆå
- `GCS_UPLOAD_ENABLED`: GCSè‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–ï¼ˆ`true`/`false`ï¼‰
- `GCS_PROJECT_ID`: Google Cloudãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDï¼ˆçœç•¥æ™‚ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä½¿ç”¨ï¼‰

å‡¦ç†æ™‚é–“ã®é•·ã„ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚„å¤§ããªPDFãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒç™ºç”Ÿã™ã‚‹å ´åˆã¯ã€ã“ã‚Œã‚‰ã®å€¤ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
polibase/
â”œâ”€â”€ src/                          # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ cli.py                   # çµ±ä¸€CLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ process_minutes.py       # è­°äº‹éŒ²åˆ†å‰²å‡¦ç†
â”‚   â”œâ”€â”€ extract_speakers_from_minutes.py   # ç™ºè¨€è€…æŠ½å‡ºå‡¦ç†
â”‚   â”œâ”€â”€ update_speaker_links.py  # ç™ºè¨€è€…ç´ä»˜ã‘æ›´æ–°ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰
â”‚   â”œâ”€â”€ update_speaker_links_llm.py # LLMãƒ™ãƒ¼ã‚¹ç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ update_speaker_links_llm_refactored.py # LLMãƒ™ãƒ¼ã‚¹ç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç‰ˆï¼‰
â”‚   â”œâ”€â”€ config/                   # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”œâ”€â”€ database.py          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®š
â”‚   â”‚   â”œâ”€â”€ config.py            # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
â”‚   â”‚   â””â”€â”€ settings.py          # ç’°å¢ƒå¤‰æ•°ç®¡ç†
â”‚   â”œâ”€â”€ common/                   # å…±é€šæ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ app_logic.py         # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…±é€šãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â””â”€â”€ database_utils.py    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…±é€šå‡¦ç†
â”‚   â”œâ”€â”€ minutes_divide_processor/ # è­°äº‹éŒ²åˆ†å‰²å‡¦ç†
â”‚   â”‚   â””â”€â”€ minutes_divider.py   # åˆ†å‰²ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ politician_extract_processor/ # æ”¿æ²»å®¶æŠ½å‡ºå‡¦ç†
â”‚   â”œâ”€â”€ web_scraper/             # è­°äº‹éŒ²Webå–å¾—
â”‚   â”‚   â”œâ”€â”€ base_scraper.py      # ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼åŸºåº•ã‚¯ãƒ©ã‚¹
â”‚   â”‚   â”œâ”€â”€ kaigiroku_net_scraper.py # kaigiroku.netå¯¾å¿œã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼
â”‚   â”‚   â””â”€â”€ scraper_service.py   # ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”œâ”€â”€ database/                 # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”‚   â”œâ”€â”€ meeting_repository.py # ä¼šè­°ãƒ‡ãƒ¼ã‚¿ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”‚   â””â”€â”€ ...                  # ãã®ä»–ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”œâ”€â”€ utils/                   # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â”‚   â””â”€â”€ gcs_storage.py       # Google Cloud Storageãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆGCS URIå¯¾å¿œï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                  # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆClean Architectureï¼‰
â”‚   â”‚   â”œâ”€â”€ entities/            # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py         # åŸºåº•ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
â”‚   â”‚   â”‚   â”œâ”€â”€ governing_body.py
â”‚   â”‚   â”‚   â”œâ”€â”€ conference.py
â”‚   â”‚   â”‚   â”œâ”€â”€ meeting.py
â”‚   â”‚   â”‚   â”œâ”€â”€ politician.py
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ repositories/        # ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py         # åŸºåº•ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ services/           # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚       â”œâ”€â”€ speaker_domain_service.py
â”‚   â”‚       â”œâ”€â”€ politician_domain_service.py
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ application/            # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆClean Architectureï¼‰
â”‚   â”‚   â”œâ”€â”€ dtos/              # ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ speaker_dto.py
â”‚   â”‚   â”‚   â”œâ”€â”€ politician_dto.py
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ usecases/          # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
â”‚   â”‚       â”œâ”€â”€ process_minutes_usecase.py
â”‚   â”‚       â”œâ”€â”€ match_speakers_usecase.py
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/         # ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ï¼ˆClean Architectureï¼‰
â”‚   â”‚   â”œâ”€â”€ persistence/       # ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–å®Ÿè£…
â”‚   â”‚   â”‚   â”œâ”€â”€ base_repository_impl.py
â”‚   â”‚   â”‚   â””â”€â”€ speaker_repository_impl.py
â”‚   â”‚   â””â”€â”€ external/          # å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº
â”‚   â”‚       â”œâ”€â”€ llm_service.py
â”‚   â”‚       â”œâ”€â”€ storage_service.py
â”‚   â”‚       â””â”€â”€ web_scraper_service.py
â”‚   â”‚
â”‚   â””â”€â”€ interfaces/             # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆClean Architectureï¼‰
â”‚       â”œâ”€â”€ cli/               # CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆäºˆå®šï¼‰
â”‚       â””â”€â”€ web/               # Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆäºˆå®šï¼‰
â”‚
â”œâ”€â”€ database/                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£
â”‚   â”œâ”€â”€ init.sql                # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ migrations/             # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ 001_add_url_to_meetings.sql
â”‚   â”‚   â”œâ”€â”€ 002_add_members_list_url_to_political_parties.sql
â”‚   â”‚   â”œâ”€â”€ 003_add_politician_details.sql
â”‚   â”‚   â”œâ”€â”€ 004_add_gcs_uri_to_meetings.sql  # GCS URIä¿å­˜ç”¨ã‚«ãƒ©ãƒ è¿½åŠ 
â”‚   â”‚   â”œâ”€â”€ 013_create_llm_processing_history.sql  # LLMå‡¦ç†å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«
â”‚   â”‚   â””â”€â”€ 014_create_prompt_versions.sql  # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«
â”‚   â””â”€â”€ backups/                # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ docker/                      # Dockeré–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ docker-compose.yml       # Docker Composeè¨­å®šï¼ˆæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ï¼‰
â”‚   â”œâ”€â”€ docker-compose.temp.yml  # Docker Composeè¨­å®šï¼ˆéæ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ï¼‰
â”‚   â””â”€â”€ Dockerfile               # Dockerã‚¤ãƒ¡ãƒ¼ã‚¸è¨­å®š
â”œâ”€â”€ scripts/                     # ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ backup-database.sh      # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ reset-database.sh       # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ test-setup.sh           # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ setup_database.sh       # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ docs/                       # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ARCHITECTURE.md         # ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£èª¬æ˜
â”‚   â””â”€â”€ CLEAN_ARCHITECTURE_MIGRATION.md  # Clean Architectureç§»è¡Œã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ data/                       # ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ tests/                      # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ domain/                # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â””â”€â”€ test_speaker_domain_service.py
â”‚   â””â”€â”€ pytest.ini              # pytestè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ backup-database.sh          # â†’ scripts/backup-database.sh (ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯)
â”œâ”€â”€ reset-database.sh           # â†’ scripts/reset-database.sh (ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯)
â”œâ”€â”€ test-setup.sh              # â†’ scripts/test-setup.sh (ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯)
â”œâ”€â”€ pyproject.toml             # Pythonä¾å­˜é–¢ä¿‚
â”œâ”€â”€ CLAUDE.md                  # Claude Codeç”¨ã‚¬ã‚¤ãƒ‰
â””â”€â”€ polibase.dbml              # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
```

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Dockeré–¢é€£ã®ã‚¨ãƒ©ãƒ¼

#### ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆ
```bash
# ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
lsof -i :5432
lsof -i :8000

# Docker Composeã‚’å†èµ·å‹•
docker compose down
docker compose up -d
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼
```bash
# PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèª
docker compose -f docker/docker-compose.yml logs postgres

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
./test-setup.sh
```

#### ã‚³ãƒ³ãƒ†ãƒŠã®ãƒªã‚»ãƒƒãƒˆ
```bash
# å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒŠã¨ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å‰Šé™¤ã—ã¦å†ä½œæˆ
docker compose -f docker/docker-compose.yml down -v
docker compose -f docker/docker-compose.yml up -d
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å•é¡Œ

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚»ãƒƒãƒˆæ–¹æ³•**:

`reset-database.sh`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆã—ã¦åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
- æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å‰Šé™¤
- ãƒ†ãƒ¼ãƒ–ãƒ«ã®å†ä½œæˆï¼ˆinit.sqlï¼‰
- å…¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨ï¼ˆmigrations/*.sqlï¼‰
- åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ï¼ˆseed_*.sqlï¼‰

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‹ã‚‰å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
./scripts/reset-database.sh

# ã¾ãŸã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰å®Ÿè¡Œ
bash scripts/reset-database.sh
```

**æ³¨æ„**:
- ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã‹ã‚‰å®Ÿè¡Œã—ã¾ã™ï¼ˆDockerå†…ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰
- å®Ÿè¡Œæ™‚ã«ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™
- å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã‚‹ãŸã‚ã€å¿…è¦ã«å¿œã˜ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–å¾—ã—ã¦ãã ã•ã„

**å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’æ®‹ã—ãŸã„å ´åˆ**:
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆã—ã¦ã‹ã‚‰ãƒªã‚»ãƒƒãƒˆ
./scripts/backup-database.sh backup
./scripts/reset-database.sh
```

**ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³**:
```bash
# ä¸è¦ãªDockerãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å‰Šé™¤
docker volume prune

# å¤ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å‰Šé™¤
docker image prune -a
```

### Pythonç’°å¢ƒã®å•é¡Œ

#### uvãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
```bash
# uvã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl -LsSf https://astral.sh/uv/install.sh | sh
source $HOME/.cargo/env
```

#### ä¾å­˜é–¢ä¿‚ã®å•é¡Œ
```bash
# ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync --reinstall
```

### Google Cloud Storageé–¢é€£ã®å•é¡Œ

#### èªè¨¼ã‚¨ãƒ©ãƒ¼
```bash
# GCPèªè¨¼ã‚’å†è¨­å®š
gcloud auth application-default login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDã‚’è¨­å®š
gcloud config set project YOUR_PROJECT_ID
```

#### ãƒã‚±ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼
```bash
# ãƒã‚±ãƒƒãƒˆã®å­˜åœ¨ç¢ºèª
gsutil ls gs://YOUR_BUCKET_NAME/

# æ¨©é™ã®ç¢ºèª
gsutil iam get gs://YOUR_BUCKET_NAME/
```

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Clean Architecture

Polibaseã¯ã€ä¿å®ˆæ€§ã¨æ‹¡å¼µæ€§ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚Clean Architectureã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

**ç§»è¡ŒçŠ¶æ³**: ğŸŸ¢ **90%å®Œäº†** - ã‚³ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯å®Œå…¨ã«å®Ÿè£…ã•ã‚Œã€ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãŒé€²è¡Œä¸­ã§ã™ã€‚

#### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

1. **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤** (`src/domain/`) - âœ… å®Œå…¨å®Ÿè£…
   - **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£** (21ãƒ•ã‚¡ã‚¤ãƒ«): ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å«ã‚€ä¸­å¿ƒçš„ãªãƒ“ã‚¸ãƒã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
     - `BaseEntity`: å…±é€šåŸºåº•ã‚¯ãƒ©ã‚¹
     - ä¸»è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£: `Politician`, `Speaker`, `Meeting`, `Conference`, `Proposal` ãªã©
   - **ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** (22ãƒ•ã‚¡ã‚¤ãƒ«): ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã®æŠ½è±¡åŒ–
     - `BaseRepository[T]`: ã‚¸ã‚§ãƒãƒªãƒƒã‚¯åŸºåº•ãƒªãƒã‚¸ãƒˆãƒª
     - `ISessionAdapter`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒã‚·ãƒ§ãƒ³æŠ½è±¡åŒ–ï¼ˆIssue #592ã§å®Œå…¨æ€§é”æˆï¼‰
   - **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹** (18ãƒ•ã‚¡ã‚¤ãƒ«): ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å±ã•ãªã„ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
     - `SpeakerDomainService`, `PoliticianDomainService`, `MinutesDomainService` ãªã©
   - **ã‚µãƒ¼ãƒ“ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** (8ãƒ•ã‚¡ã‚¤ãƒ«): å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®æŠ½è±¡åŒ–
     - `ILLMService`, `IStorageService`, `IWebScraperService` ãªã©

2. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤** (`src/application/`) - âœ… å®Œå…¨å®Ÿè£…
   - **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹** (21ãƒ•ã‚¡ã‚¤ãƒ«): ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«
     - `ProcessMinutesUseCase`: è­°äº‹éŒ²å‡¦ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
     - `MatchSpeakersUseCase`: ç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°
     - `ScrapePoliticiansUseCase`: æ”¿æ²»å®¶æƒ…å ±åé›†
     - ãã®ä»–ç®¡ç†ç³»ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
   - **DTO** (16ãƒ•ã‚¡ã‚¤ãƒ«): ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
     - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®æ¼æ´©ã‚’é˜²ã
     - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€

3. **ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤** (`src/infrastructure/`) - âœ… å®Œå…¨å®Ÿè£…
   - **æ°¸ç¶šåŒ–** (22+ãƒ•ã‚¡ã‚¤ãƒ«): ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã®å®Ÿè£…
     - `BaseRepositoryImpl[T]`: ã‚¸ã‚§ãƒãƒªãƒƒã‚¯SQLAlchemyãƒªãƒã‚¸ãƒˆãƒª
     - ã™ã¹ã¦ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒªãƒã‚¸ãƒˆãƒªã«å¯¾å¿œã™ã‚‹å®Ÿè£…
     - `AsyncSessionAdapter`: åŒæœŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã®asyncãƒ©ãƒƒãƒ‘ãƒ¼
     - `UnitOfWorkImpl`: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
   - **å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹**: LLMã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã®å®Ÿè£…
     - `GeminiLLMService`: Google Gemini APIçµ±åˆ
     - `CachedLLMService`, `InstrumentedLLMService`: ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼
     - `GCSStorageService`: Google Cloud Storageçµ±åˆ
     - `WebScraperService`: Playwright Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°
   - **ãã®ä»–**: DI Container, Logging, Monitoring, Error Handling

4. **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤** (`src/interfaces/`) - âœ… å¤§éƒ¨åˆ†å®Œäº†
   - **CLI** (`src/interfaces/cli/`): ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
     - çµ±ä¸€CLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ: `polibase`ã‚³ãƒãƒ³ãƒ‰
     - æ§‹é€ åŒ–ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ç¾¤: scraping, database, processing, monitoring
   - **Web** (`src/interfaces/web/streamlit/`): Streamlit Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
     - Views, Presenters, Components, DTOsã§æ§‹æˆ
     - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨UIã®å®Œå…¨åˆ†é›¢

#### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç‰¹å¾´

**å®Œå…¨ãªä¾å­˜æ€§é€†è»¢**:
- ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ãŒã™ã¹ã¦ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©
- ã‚¤ãƒ³ãƒ•ãƒ©å±¤ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…
- ä¾‹: `ISessionAdapter` (domain) â† `AsyncSessionAdapter` (infrastructure)

**é«˜ã„ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§**:
- ãƒ¢ãƒƒã‚¯ã‚„ã‚¹ã‚¿ãƒ–ã®ä½œæˆãŒå®¹æ˜“
- ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’å¤–éƒ¨ä¾å­˜ãªã—ã§ãƒ†ã‚¹ãƒˆå¯èƒ½
- çµ±åˆãƒ†ã‚¹ãƒˆã¨ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®æ˜ç¢ºãªåˆ†é›¢

**å°†æ¥ã®æ‹¡å¼µæ€§**:
- æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¸ã®å¯¾å¿œãŒå®¹æ˜“
- LLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆãŒå®¹æ˜“
- UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å¤‰æ›´ãŒå®¹æ˜“

#### ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦

ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ®µéšçš„ã«å»ƒæ­¢äºˆå®šã§ã™ï¼š
- `src/cli.py` â†’ `src/interfaces/cli/cli.py` ã¸ç§»è¡Œæ¸ˆã¿
- `src/streamlit/` â†’ `src/interfaces/web/streamlit/` ã¸ç§»è¡Œæ¸ˆã¿
- `src/monitoring_app.py` â†’ `src/interfaces/metrics_app.py` ã¸ç§»è¡Œæ¸ˆã¿

è©³ç´°ã¯ `tmp/clean_architecture_analysis_2025.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#### å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Clean Architectureç§»è¡Œã‚¬ã‚¤ãƒ‰](docs/CLEAN_ARCHITECTURE_MIGRATION.md) - ç§»è¡Œã®è©³ç´°æ‰‹é †
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†æãƒ¬ãƒãƒ¼ãƒˆ](tmp/clean_architecture_analysis_2025.md) - å®Ÿè£…çŠ¶æ³ã®è©³ç´°åˆ†æ

## ğŸ—‚ï¸ ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œ

### æ¨™æº–ãƒ•ãƒ­ãƒ¼ï¼ˆPDFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å‡¦ç†ï¼‰
1. **è­°äº‹éŒ²PDFã®å‡¦ç†**: `src/process_minutes.py` - è­°äº‹éŒ²ã‚’ç™ºè¨€å˜ä½ã«åˆ†å‰²ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
2. **ç™ºè¨€è€…æƒ…å ±ã®æŠ½å‡º**: `src/extract_speakers_from_minutes.py` - ç™ºè¨€ã‹ã‚‰ç™ºè¨€è€…æƒ…å ±ã‚’æŠ½å‡ºã—ã¦speakersãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜
3. **ç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°**: `update_speaker_links_llm.py` - LLMã‚’æ´»ç”¨ã—ã¦ç™ºè¨€ã¨ç™ºè¨€è€…ã‚’é«˜ç²¾åº¦ã§ãƒãƒƒãƒãƒ³ã‚°
4. **æ”¿æ²»å®¶æƒ…å ±ã®å–å¾—**: `polibase scrape-politicians` - æ”¿å…šã®Webã‚µã‚¤ãƒˆã‹ã‚‰æœ€æ–°ã®æ”¿æ²»å®¶æƒ…å ±ã‚’å–å¾—
5. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜**: æŠ½å‡ºãƒ»ãƒãƒƒãƒãƒ³ã‚°ã•ã‚ŒãŸæƒ…å ±ã‚’PostgreSQLã«ä¿å­˜
6. **åˆ†æãƒ»æ¤œç´¢**: è“„ç©ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ”¿æ²»æ´»å‹•ã‚’åˆ†æ

### Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ•ãƒ­ãƒ¼ï¼ˆGCSçµ±åˆï¼‰
1. **è­°äº‹éŒ²Webå–å¾—**: `polibase scrape-minutes` - Webã‹ã‚‰è­°äº‹éŒ²ã‚’å–å¾—
2. **GCSä¿å­˜**: å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Google Cloud Storageã«è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
3. **URIè¨˜éŒ²**: GCS URIã‚’meetingsãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜
4. **GCSã‹ã‚‰å‡¦ç†**: `process_minutes.py --meeting-id` ã§GCSã‹ã‚‰ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦å‡¦ç†
5. **å¾Œç¶šå‡¦ç†**: æ”¿æ²»å®¶æŠ½å‡ºã€ç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°ãªã©ã®å‡¦ç†ã‚’å®Ÿè¡Œ

### LLMå‡¦ç†å±¥æ­´ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
#### å‡¦ç†å±¥æ­´ã®è¨˜éŒ²ï¼ˆllm_processing_historyãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- **çµ±ä¸€çš„ãªå±¥æ­´ç®¡ç†**: ã™ã¹ã¦ã®LLMå‡¦ç†ã‚’1ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†
- **å‡¦ç†ã‚¿ã‚¤ãƒ—**: MINUTES_DIVISIONï¼ˆè­°äº‹éŒ²åˆ†å‰²ï¼‰ã€SPEECH_EXTRACTIONï¼ˆç™ºè¨€æŠ½å‡ºï¼‰ã€SPEAKER_MATCHINGï¼ˆç™ºè¨€è€…ãƒãƒƒãƒãƒ³ã‚°ï¼‰ã€POLITICIAN_EXTRACTIONï¼ˆæ”¿æ²»å®¶æŠ½å‡ºï¼‰ãªã©
- **è©³ç´°ãªè¨˜éŒ²å†…å®¹**:
  - ä½¿ç”¨ã—ãŸLLMãƒ¢ãƒ‡ãƒ«åã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³
  - å…¥åŠ›ãƒ»å‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã¨ã‚³ã‚¹ãƒˆ
  - å‡¦ç†æ™‚é–“ã¨æˆåŠŸ/å¤±æ•—çŠ¶æ…‹
  - ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  - å‡¦ç†å¯¾è±¡ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£IDï¼ˆmeeting_idã€speaker_idãªã©ï¼‰
- **æ´»ç”¨ä¾‹**:
  - å‡¦ç†ã®æˆåŠŸç‡åˆ†æ
  - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®ãŸã‚ã®ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡åˆ†æ
  - ã‚¨ãƒ©ãƒ¼å‚¾å‘ã®æŠŠæ¡ã¨æ”¹å–„

#### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆprompt_versionsãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¤‰æ›´å±¥æ­´ã‚’å®Œå…¨ã«è¿½è·¡
- **ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: å„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚­ãƒ¼ï¼ˆminutes_divideã€speaker_matchãªã©ï¼‰ã”ã¨ã«1ã¤ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†
- **å¤‰æ•°å¯¾å¿œ**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…ã®å¤‰æ•°ã‚’è‡ªå‹•æ¤œå‡ºã—ã€å®Ÿè¡Œæ™‚ã«æ¤œè¨¼
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ã€ä½¿ç”¨ä¸Šã®æ³¨æ„ãªã©ã‚’ä¿å­˜
- **æ´»ç”¨ä¾‹**:
  - éå»ã®å‡¦ç†ã®å®Œå…¨ãªå†ç¾
  - A/Bãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹å–„
  - åŠ¹æœçš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®åˆ†æã¨å…±æœ‰

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

```bash
# ğŸ—ï¸ åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
cp .env.example .env
docker compose -f docker/docker-compose.yml up -d
./test-setup.sh

# ğŸ”„ é€šå¸¸ã®èµ·å‹•ãƒ»åœæ­¢
docker compose -f docker/docker-compose.yml up -d      # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰èµ·å‹•
docker compose -f docker/docker-compose.yml down       # åœæ­¢ï¼ˆãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒï¼‰

# ğŸƒ ä¸»è¦ãªå‡¦ç†å®Ÿè¡Œ
docker compose -f docker/docker-compose.yml exec polibase uv run polibase process-minutes      # è­°äº‹éŒ²åˆ†å‰²
docker compose -f docker/docker-compose.yml exec polibase uv run polibase streamlit           # Web UIèµ·å‹•
docker compose -f docker/docker-compose.yml exec polibase uv run polibase monitoring          # ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
```

ğŸ“š **ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã®è©³ç´°ã¯ [COMMANDS.md](COMMANDS.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**
